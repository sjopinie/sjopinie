<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>{% block title %}{% endblock %} {{user.tenant.schema_name}}</title>
    {% load static %}
    <link
      rel="stylesheet"
      type="text/css"
      href="{% static 'sjopinie_app/style.css' %}"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com/" />
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
  </head>
  <body>
    <div class="website-container">
      <header class="page-header">
        <div class="logo">
          <a href="/" style="font-weight: 700">sjopinie.pl</a>
        </div>

        {% if user.is_authenticated %}
        <div class="search-bar">
          <input
            id="navbar-search-text"
            type="search"
            name="search-bar"
            placeholder="Wyszukaj... dla {{user.tenant.schema_name}}"
          />
          <button
            id="navbar-search-button"
            type="submit"
            name="search"
            class="search-button"
          >
            <span class="material-icons-outlined"> search </span>
          </button>
        </div>

        <div class="user-menu">
          <img
            src="{% static 'sjopinie_app/media/avatar/avatar.svg' %}"
            class="left"
            width="30px"
            height="30px;"
          />
          <span class="user-menu-nickname"
            ><a class="navbar-list-el" href="/api-auth/logout/"
              >{{user.get_username}} (wyloguj)</a
            ></span
          >
        </div>
        {% else %}
        <div class="user-menu">
          <img
            src="{% static 'sjopinie_app/media/avatar/avatar.svg' %}"
            class="left"
            width="30px"
            height="30px;"
          />
          <span class="user-menu-nickname"
            ><a class="navbar-list-el" href="/login/">Zaloguj</a></span
          >
        </div>
        {% endif %}
      </header>
      <div style="clear: both"></div>
    </div>
    <!-- Load development version ov VUE TODO change to production one at the end -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <div class="website-container">
      <div class="body-content page-sheet shadow">
        {% block content %} {% endblock %}
      </div>

      <div class="page-sheet footer-content">
        <hr />
        <footer>
          <p>Copyright Â© 2021 sjopinie Team</p>
        </footer>
      </div>
    </div>

    {% if user.is_authenticated %}
    <script async>
      document
        .querySelector("#navbar-search-text")
        .addEventListener("keyup", function (event) {
          // Number 13 is the "Enter" key on the keyboard
          if (event.keyCode === 13) {
            // Cancel the default action, if needed
            event.preventDefault();
            // Trigger the button element with a click
            document.getElementById("navbar-search-button").click();
          }
        });
      document.querySelector("#navbar-search-button").onclick = function () {
        let query = document.querySelector("#navbar-search-text").value;
        if (query) {
          location.href = "/search/" + query;
        }
      };
    </script>

    {% endif %} {% block load-scripts %} {% endblock %}
  </body>
</html>
